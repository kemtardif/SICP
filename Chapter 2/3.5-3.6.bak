#lang sicp
;==========================================3.5=====================================

; We recall the Monte-Carlo procedure :

(define (monte-carlo trials experiment)
  (define (iter remaining success)
    (cond ((= remaining 0)
           (/ success trials))
          ((experiment)
           (iter (- remaining 1) (+ success 1)))
          (else (iter (- remaining 1) success))))
  (iter trials 0))

;For vectors (x1, y1), (x2, y2), opposite corners of a rectangle, the area is given by :

(define (area x1 y1 x2 y2)
  (* (- x2 x1) (- y2 y1)))

;We will also need the following random number generator :

(define (random-in-range low high)
  (let ((range (- high low)))
    (+ low (random range))))

;We can then write :

(define (estimate-integral predicate x1 y1 x2 y2 trials)  
  (define area
    (* (- x2 x1) (- y2 y1)))
  (define (experiment)
    (predicate (random-in-range x1 x2)
               (random-in-range y1 y2)))
  (* area (monte-carlo trials experiment)))

(define (pi-predicate x y)
  (<= (+ (* x x) (* y y)) 1))

(estimate-integral pi-predicate -1.0 -1.0 1.0 1.0 10)
(estimate-integral pi-predicate -1.0 -1.0 1.0 1.0 100)
(estimate-integral pi-predicate -1.0 -1.0 1.0 1.0 1000)
(estimate-integral pi-predicate -1.0 -1.0 1.0 1.0 10000)
(estimate-integral pi-predicate -1.0 -1.0 1.0 1.0 100000)
(estimate-integral pi-predicate -1.0 -1.0 1.0 1.0 1000000)
(estimate-integral pi-predicate -1.0 -1.0 1.0 1.0 10000000)

;====================================3.6=============================


(define (rand action)
  (let ((x init-value))
    (cond ((eq? action 'generate)
           (begin (set! x (rand-update x) x)))
          ((eq? action 'reset)
           (lambda (newValue) (begin (set! x newValue) x)))
          (else (error "Action not defined")))))
